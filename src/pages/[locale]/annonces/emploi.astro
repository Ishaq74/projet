---
// Emploi page - Job listings
import Layout from '../../../layouts/Layout.astro';
import Navigation from '../../../components/Navigation.astro';
import { loadTranslations, t, locales } from '../../../utils/i18n';
import type { Locale } from '../../../types/i18n';

export async function getStaticPaths() {
  return locales.map((localeConfig) => ({
    params: { locale: localeConfig.code },
  }));
}

const { locale } = Astro.params;
const translations = await loadTranslations(locale as Locale);

const title = `${t(translations, 'nav.emploi')} - Salut Annecy`;
const description = "Offres d'emploi et opportunit√©s de carri√®re √† Annecy et dans le bassin ann√©cien.";

// Mock job listings
const jobs = [
  {
    id: 1,
    title: "D√©veloppeur Full Stack React/Node.js",
    company: "TechAnnecy",
    location: "Annecy Centre",
    type: "CDI",
    salary: "45-55k‚Ç¨",
    description: "Rejoignez notre √©quipe pour d√©velopper des applications web innovantes...",
    tags: ["React", "Node.js", "JavaScript", "MongoDB"],
    postedDate: "2024-01-15",
    urgent: true
  },
  {
    id: 2,
    title: "Chef de Projet Digital",
    company: "Agence Digitale Savoie",
    location: "Seynod",
    type: "CDI",
    salary: "40-50k‚Ç¨",
    description: "Pilotage de projets digitaux pour nos clients locaux et internationaux...",
    tags: ["Gestion de projet", "Digital", "Client"],
    postedDate: "2024-01-14",
    urgent: false
  },
  {
    id: 3,
    title: "Serveur/Serveuse Restaurant",
    company: "Le Bistrot du Lac",
    location: "Annecy",
    type: "CDD",
    salary: "SMIC + pourboires",
    description: "Restaurant face au lac recherche serveur/serveuse pour la saison...",
    tags: ["Service", "Restauration", "Saisonnier"],
    postedDate: "2024-01-13",
    urgent: false
  }
];

const jobTypes = ["Tous", "CDI", "CDD", "Stage", "Freelance", "Saisonnier"];
const sectors = ["Tous", "Tech/Digital", "Restauration", "Tourisme", "Commerce", "Sant√©", "Education"];
---

<Layout title={title} description={description} locale={locale}>
  <Navigation locale={locale} currentPath="/annonces/emploi" />
  
  <main class="jobs-page">
    <section class="hero-section">
      <div class="container">
        <h1>{t(translations, 'nav.emploi')}</h1>
        <p>Trouvez votre prochain emploi √† Annecy et dans le bassin ann√©cien</p>
        <div class="search-bar">
          <input type="text" placeholder="Rechercher un poste..." class="search-input" />
          <input type="text" placeholder="Lieu" class="location-input" />
          <button class="search-btn">Rechercher</button>
        </div>
      </div>
    </section>

    <section class="filters-section">
      <div class="container">
        <div class="filters-grid">
          <div class="filter-group">
            <label>Type de contrat :</label>
            <div class="filter-options">
              {jobTypes.map((type) => (
                <button class={`filter-btn ${type === 'Tous' ? 'active' : ''}`}>
                  {type}
                </button>
              ))}
            </div>
          </div>
          <div class="filter-group">
            <label>Secteur :</label>
            <div class="filter-options">
              {sectors.map((sector) => (
                <button class={`filter-btn ${sector === 'Tous' ? 'active' : ''}`}>
                  {sector}
                </button>
              ))}
            </div>
          </div>
        </div>
      </div>
    </section>

    <section class="results-section">
      <div class="container">
        <div class="results-header">
          <h2>{jobs.length} offres d'emploi</h2>
          <select class="sort-select">
            <option>Plus r√©centes</option>
            <option>Plus pertinentes</option>
            <option>Salaire croissant</option>
            <option>Salaire d√©croissant</option>
          </select>
        </div>

        <div class="jobs-list">
          {jobs.map((job) => (
            <article class="job-card">
              {job.urgent && <div class="urgent-badge">Urgent</div>}
              <div class="job-header">
                <h3 class="job-title">{job.title}</h3>
                <div class="job-meta">
                  <span class="company">{job.company}</span>
                  <span class="location">üìç {job.location}</span>
                  <span class="date">üìÖ {new Date(job.postedDate).toLocaleDateString('fr-FR')}</span>
                </div>
              </div>
              
              <div class="job-details">
                <div class="job-type-salary">
                  <span class="job-type">{job.type}</span>
                  <span class="salary">{job.salary}</span>
                </div>
                <p class="job-description">{job.description}</p>
                <div class="job-tags">
                  {job.tags.map((tag) => (
                    <span class="tag">{tag}</span>
                  ))}
                </div>
              </div>
              
              <div class="job-actions">
                <button class="btn btn-primary">Postuler</button>
                <button class="btn btn-ghost">Sauvegarder</button>
                <a href={`/${locale}/annonces/emploi/${job.id}`} class="btn btn-ghost">
                  Voir d√©tails
                </a>
              </div>
            </article>
          ))}
        </div>

        <div class="cta-section">
          <h3>Recruteurs ?</h3>
          <p>Publiez vos offres d'emploi et touchez les talents locaux d'Annecy.</p>
          <a href={`/${locale}/annonces/emploi/publier`} class="btn btn-primary btn-lg">
            Publier une offre
          </a>
        </div>
      </div>
    </section>
  </main>
</Layout>

<style>
  .jobs-page {
    min-height: 100vh;
  }

  .hero-section {
    background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
    color: white;
    padding: 4rem 0;
    text-align: center;
  }

  .hero-section h1 {
    font-size: 3rem;
    font-weight: 700;
    margin-bottom: 1rem;
  }

  .hero-section p {
    font-size: 1.25rem;
    margin-bottom: 2rem;
    opacity: 0.9;
  }

  .search-bar {
    display: flex;
    max-width: 600px;
    margin: 0 auto;
    gap: 1rem;
    flex-wrap: wrap;
  }

  .search-input,
  .location-input {
    flex: 1;
    min-width: 200px;
    padding: 1rem;
    border: none;
    border-radius: 0.5rem;
    font-size: 1rem;
  }

  .search-btn {
    padding: 1rem 2rem;
    background: rgba(255, 255, 255, 0.2);
    color: white;
    border: 2px solid white;
    border-radius: 0.5rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
  }

  .search-btn:hover {
    background: white;
    color: #3b82f6;
  }

  .filters-section {
    padding: 2rem 0;
    background: #f8f9fa;
  }

  .filters-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 2rem;
  }

  .filter-group label {
    display: block;
    font-weight: 600;
    margin-bottom: 1rem;
    color: #374151;
  }

  .filter-options {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
  }

  .filter-btn {
    padding: 0.5rem 1rem;
    border: 1px solid #d1d5db;
    background: white;
    border-radius: 2rem;
    font-size: 0.875rem;
    cursor: pointer;
    transition: all 0.2s;
  }

  .filter-btn:hover,
  .filter-btn.active {
    background: #3b82f6;
    color: white;
    border-color: #3b82f6;
  }

  .results-section {
    padding: 3rem 0;
  }

  .results-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 2rem;
  }

  .results-header h2 {
    font-size: 1.5rem;
    font-weight: 700;
    color: #1f2937;
  }

  .sort-select {
    padding: 0.5rem 1rem;
    border: 1px solid #d1d5db;
    border-radius: 0.375rem;
    background: white;
  }

  .jobs-list {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
    margin-bottom: 3rem;
  }

  .job-card {
    background: white;
    border-radius: 0.75rem;
    padding: 2rem;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
    position: relative;
    transition: transform 0.2s, box-shadow 0.2s;
  }

  .job-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px -5px rgba(0, 0, 0, 0.1);
  }

  .urgent-badge {
    position: absolute;
    top: 1rem;
    right: 1rem;
    background: #ef4444;
    color: white;
    padding: 0.25rem 0.75rem;
    border-radius: 1rem;
    font-size: 0.75rem;
    font-weight: 600;
  }

  .job-header {
    margin-bottom: 1rem;
  }

  .job-title {
    font-size: 1.25rem;
    font-weight: 700;
    color: #1f2937;
    margin-bottom: 0.5rem;
  }

  .job-meta {
    display: flex;
    gap: 1rem;
    flex-wrap: wrap;
    font-size: 0.875rem;
    color: #6b7280;
  }

  .company {
    font-weight: 600;
    color: #3b82f6;
  }

  .job-details {
    margin-bottom: 1.5rem;
  }

  .job-type-salary {
    display: flex;
    gap: 1rem;
    margin-bottom: 1rem;
  }

  .job-type {
    background: #dbeafe;
    color: #1e40af;
    padding: 0.25rem 0.75rem;
    border-radius: 1rem;
    font-size: 0.75rem;
    font-weight: 600;
  }

  .salary {
    background: #d1fae5;
    color: #065f46;
    padding: 0.25rem 0.75rem;
    border-radius: 1rem;
    font-size: 0.75rem;
    font-weight: 600;
  }

  .job-description {
    color: #4b5563;
    line-height: 1.5;
    margin-bottom: 1rem;
  }

  .job-tags {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
  }

  .tag {
    background: #f3f4f6;
    color: #374151;
    padding: 0.25rem 0.5rem;
    border-radius: 0.25rem;
    font-size: 0.75rem;
  }

  .job-actions {
    display: flex;
    gap: 1rem;
    flex-wrap: wrap;
  }

  .btn {
    padding: 0.5rem 1rem;
    border-radius: 0.375rem;
    font-weight: 600;
    text-decoration: none;
    border: none;
    cursor: pointer;
    transition: all 0.2s;
    font-size: 0.875rem;
  }

  .btn-primary {
    background: #3b82f6;
    color: white;
  }

  .btn-primary:hover {
    background: #2563eb;
  }

  .btn-ghost {
    background: transparent;
    color: #6b7280;
    border: 1px solid #d1d5db;
  }

  .btn-ghost:hover {
    background: #f9fafb;
    color: #374151;
  }

  .cta-section {
    background: #f8f9fa;
    border-radius: 1rem;
    padding: 3rem;
    text-align: center;
  }

  .cta-section h3 {
    font-size: 2rem;
    font-weight: 700;
    margin-bottom: 1rem;
    color: #1f2937;
  }

  .cta-section p {
    color: #6b7280;
    margin-bottom: 2rem;
    font-size: 1.125rem;
  }

  .btn-lg {
    padding: 1rem 2rem;
    font-size: 1.125rem;
  }

  @media (max-width: 768px) {
    .hero-section h1 {
      font-size: 2rem;
    }

    .search-bar {
      flex-direction: column;
    }

    .search-input,
    .location-input {
      min-width: unset;
    }

    .results-header {
      flex-direction: column;
      gap: 1rem;
      align-items: flex-start;
    }

    .job-meta {
      flex-direction: column;
      gap: 0.5rem;
    }

    .job-actions {
      flex-direction: column;
    }

    .btn {
      text-align: center;
    }
  }
</style>