---
// ULTIMATE HOMEPAGE - PERFECT INTEGRATION OF DESIGN SYSTEM
import Layout from '../../layouts/Layout.astro';
import Navbar from '../../components/organisms/navbar.astro';
import Hero from '../../components/organisms/hero.astro';
import Container from '../../components/atoms/container.astro';
import Heading from '../../components/atoms/heading.astro';
import Paragraph from '../../components/atoms/paragraph.astro';
import Button from '../../components/atoms/button.astro';
import Card from '../../components/molecules/card.astro';
import Icon from '../../components/atoms/icon.astro';
import Badge from '../../components/atoms/badge.astro';
import Avatar from '../../components/atoms/avatar.astro';
import Chip from '../../components/atoms/chip.astro';
import { loadTranslations, t, locales } from '../../utils/i18n';
import type { Locale } from '../../types/i18n';

export async function getStaticPaths() {
  return locales.map((localeConfig) => ({
    params: { locale: localeConfig.code },
  }));
}

const { locale } = Astro.params;
const translations = await loadTranslations(locale as Locale);

const title = t(translations, 'seo.home.title');
const description = t(translations, 'seo.home.description');

const jsonLd = {
  "@context": "https://schema.org",
  "@type": "WebSite",
  "name": "Salut Annecy - Plateforme Communautaire Ultime",
  "description": description,
  "url": Astro.site?.toString(),
  "inLanguage": locale,
  "potentialAction": {
    "@type": "SearchAction",
    "target": `${Astro.site?.toString()}/${locale}/search?q={search_term_string}`,
    "query-input": "required name=search_term_string"
  }
};

// Features data with comprehensive information
const features = [
  {
    icon: 'location',
    title: 'Découverte Locale',
    description: 'Restaurants, hébergements, activités et événements du bassin annécien avec avis détaillés.',
    color: 'primary',
    stats: { count: '2500+', label: 'Lieux référencés' }
  },
  {
    icon: 'users',
    title: 'Communauté Active',
    description: 'Forums et groupes pour échanger avec habitants et visiteurs de la région.',
    color: 'secondary',
    stats: { count: '15k+', label: 'Membres actifs' }
  },
  {
    icon: 'briefcase',
    title: 'Petites Annonces',
    description: 'Emploi, immobilier, vente entre particuliers dans la région d\'Annecy.',
    color: 'accent',
    stats: { count: '800+', label: 'Annonces actives' }
  },
  {
    icon: 'map',
    title: 'Sentiers & Nature',
    description: 'Randonnées, sentiers et espaces naturels autour du magnifique lac d\'Annecy.',
    color: 'success',
    stats: { count: '150+', label: 'Itinéraires' }
  }
];

// Popular categories
const categories = [
  { name: 'Restaurants', count: 450, color: 'primary' },
  { name: 'Hébergements', count: 280, color: 'secondary' },
  { name: 'Activités', count: 320, color: 'accent' },
  { name: 'Événements', count: 120, color: 'success' },
  { name: 'Sentiers', count: 150, color: 'warning' },
  { name: 'Services', count: 200, color: 'info' }
];

// Community stats
const communityStats = [
  { label: 'Membres', value: '15,247', icon: 'users' },
  { label: 'Avis', value: '8,950', icon: 'star' },
  { label: 'Photos', value: '12,300', icon: 'image' },
  { label: 'Messages', value: '45,600', icon: 'message-circle' }
];
---

<Layout 
  title={title}
  description={description}
  locale={locale as Locale}
  jsonLd={jsonLd}
>
  <Navbar slot="header" locale={locale as Locale} currentPath="/" />
  
  <!-- ULTIMATE HERO SECTION -->
  <Hero
    title="Salut Annecy"
    subtitle="Bienvenue dans"
    description="La plateforme communautaire ultime du bassin annécien. Découvrez, partagez et vivez Annecy comme un local !"
    variant="gradient"
    size="xl"
    ctaPrimary={{
      text: "Explorer Annecy",
      href: `/${locale}/discover`
    }}
    ctaSecondary={{
      text: "Rejoindre la communauté",
      href: `/${locale}/register`
    }}
  >
    <!-- Hero Stats -->
    <div class="hero-stats">
      <div class="hero-stats__grid">
        {communityStats.map(stat => (
          <div class="hero-stats__item">
            <Icon name={stat.icon} size="md" color="primary" />
            <div class="hero-stats__content">
              <div class="hero-stats__value">{stat.value}</div>
              <div class="hero-stats__label">{stat.label}</div>
            </div>
          </div>
        ))}
      </div>
    </div>
  </Hero>

  <!-- FEATURES SECTION WITH PERFECT CARDS -->
  <section class="features-section">
    <Container size="xl" padding="xl">
      <div class="section-header">
        <Heading level={2} size="4xl" align="center" color="primary">
          Tout Annecy dans votre poche
        </Heading>
        <Paragraph size="xl" color="secondary" align="center" spacing="relaxed">
          Une plateforme complète pour découvrir, vivre et partager l'expérience annécienne
        </Paragraph>
      </div>

      <div class="features-grid">
        {features.map(feature => (
          <Card variant="elevated" padding="lg" hoverable class="feature-card">
            <div class="feature-header">
              <div class="feature-icon">
                <Icon name={feature.icon} size="xl" color="primary" />
              </div>
              <Badge variant="soft" color="primary" size="sm">
                {feature.stats.label}
              </Badge>
            </div>
            
            <div class="feature-content">
              <Heading level={3} size="xl" color="primary">
                {feature.title}
              </Heading>
              <Paragraph color="secondary" spacing="relaxed">
                {feature.description}
              </Paragraph>
              
              <div class="feature-stats">
                <span class="feature-stats__number">{feature.stats.count}</span>
                <span class="feature-stats__label">{feature.stats.label}</span>
              </div>
            </div>
            
            <div class="feature-action">
              <Button 
                variant="secondary" 
                size="sm"
                href={`/${locale}/explore/${feature.title.toLowerCase()}`}
              >
                Explorer
              </Button>
            </div>
          </Card>
        ))}
      </div>
    </Container>
  </section>

  <!-- CATEGORIES SECTION -->
  <section class="categories-section">
    <Container size="xl" padding="xl">
      <div class="section-header">
        <Heading level={2} size="3xl" align="center" color="primary">
          Catégories populaires
        </Heading>
        <Paragraph size="lg" color="secondary" align="center">
          Explorez par centres d'intérêt
        </Paragraph>
      </div>

      <div class="categories-grid">
        {categories.map(category => (
          <Chip
            variant="soft"
            color="primary"
            size="lg"
            clickable
            href={`/${locale}/category/${category.name.toLowerCase()}`}
            class="category-chip"
          >
            <span slot="icon">
              <Badge variant="solid" color="primary" size="sm">
                {category.count}
              </Badge>
            </span>
            {category.name}
          </Chip>
        ))}
      </div>
    </Container>
  </section>

  <!-- COMMUNITY SECTION -->
  <section class="community-section">
    <Container size="xl" padding="xl">
      <Card variant="elevated" padding="lg" class="community-card">
        <div class="community-content">
          <div class="community-text">
            <Heading level={2} size="3xl" color="primary">
              Rejoignez 15 000+ Annéciens
            </Heading>
            <Paragraph size="lg" color="secondary" spacing="relaxed">
              Une communauté passionnée qui partage ses bons plans, organise des événements 
              et vous aide à vivre Annecy pleinement. Membres vérifiés, modération active.
            </Paragraph>
            
            <div class="community-features">
              <div class="community-features__list">
                <div class="community-feature">
                  <Icon name="check" size="sm" color="success" />
                  <span>Conseils d'habitants authentiques</span>
                </div>
                <div class="community-feature">
                  <Icon name="check" size="sm" color="success" />
                  <span>Événements exclusifs communauté</span>
                </div>
                <div class="community-feature">
                  <Icon name="check" size="sm" color="success" />
                  <span>Support réactif et bienveillant</span>
                </div>
              </div>
            </div>

            <div class="community-actions">
              <Button variant="primary" size="lg" href={`/${locale}/register`}>
                Rejoindre gratuitement
              </Button>
              <Button variant="secondary" size="lg" href={`/${locale}/community`}>
                Découvrir la communauté
              </Button>
            </div>
          </div>

          <div class="community-avatars">
            <div class="avatars-stack">
              <Avatar 
                variant="circular" 
                size="lg" 
                name="Marie Dubois"
                status="online"
              />
              <Avatar 
                variant="circular" 
                size="lg" 
                name="Jean Martin"
                status="away"
              />
              <Avatar 
                variant="circular" 
                size="lg" 
                name="Sophie Laurent"
                status="online"
              />
              <Avatar 
                variant="circular" 
                size="lg" 
                name="Pierre Durand"
                status="online"
              />
              <div class="avatars-more">
                <span>+15k</span>
              </div>
            </div>
            
            <div class="community-testimonial">
              <blockquote>
                "Grâce à Salut Annecy, j'ai découvert des endroits magnifiques 
                que je n'aurais jamais trouvés seule !"
              </blockquote>
              <cite>— Marie, membre depuis 2 ans</cite>
            </div>
          </div>
        </div>
      </Card>
    </Container>
  </section>

  <!-- CALL TO ACTION FINAL -->
  <section class="final-cta">
    <Container size="lg" padding="xl">
      <div class="cta-content">
        <Heading level={2} size="4xl" align="center" color="inverse">
          Prêt à découvrir le vrai Annecy ?
        </Heading>
        <Paragraph size="xl" color="inverse" align="center" spacing="relaxed">
          Rejoignez la plus grande communauté du bassin annécien
        </Paragraph>
        
        <div class="cta-actions">
          <Button variant="primary" size="lg" href={`/${locale}/register`}>
            Commencer l'aventure
          </Button>
          <Button variant="ghost" size="lg" href={`/${locale}/explore`}>
            Explorer sans compte
          </Button>
        </div>

        <div class="cta-guarantee">
          <Paragraph size="sm" color="inverse" align="center">
            ✨ Gratuit • Sans pub • Respectueux de votre vie privée
          </Paragraph>
        </div>
      </div>
    </Container>
  </section>
</Layout>

<style>
  /* ===== HERO STATS ===== */
  .hero-stats {
    margin-top: var(--space-12);
    width: 100%;
  }

  .hero-stats__grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    gap: var(--space-6);
    max-width: 600px;
    margin: 0 auto;
  }

  .hero-stats__item {
    display: flex;
    align-items: center;
    gap: var(--space-3);
    padding: var(--space-4);
    background: rgba(255, 255, 255, 0.1);
    border-radius: var(--radius-lg);
    backdrop-filter: blur(10px);
  }

  .hero-stats__content {
    display: flex;
    flex-direction: column;
  }

  .hero-stats__value {
    font-size: var(--font-size-lg);
    font-weight: var(--font-weight-bold);
    color: var(--text-inverse);
    line-height: var(--line-height-tight);
  }

  .hero-stats__label {
    font-size: var(--font-size-sm);
    color: var(--text-inverse);
    opacity: var(--opacity-80);
  }

  /* ===== FEATURES SECTION ===== */
  .features-section {
    padding: var(--space-24) 0;
    background: linear-gradient(to bottom, var(--bg-primary), var(--bg-secondary));
  }

  .section-header {
    text-align: center;
    margin-bottom: var(--space-16);
    display: flex;
    flex-direction: column;
    gap: var(--space-4);
  }

  .features-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: var(--space-8);
  }

  .feature-card {
    display: flex;
    flex-direction: column;
    height: 100%;
  }

  .feature-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: var(--space-6);
  }

  .feature-icon {
    display: flex;
    align-items: center;
    justify-content: center;
    width: var(--size-16);
    height: var(--size-16);
    border-radius: var(--radius-xl);
    background: linear-gradient(135deg, var(--color-primary-50), var(--color-primary-100));
  }

  [data-theme="dark"] .feature-icon {
    background: linear-gradient(135deg, var(--color-primary-900), var(--color-primary-800));
  }

  .feature-content {
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: var(--space-4);
  }

  .feature-stats {
    display: flex;
    align-items: baseline;
    gap: var(--space-2);
    margin: var(--space-4) 0;
  }

  .feature-stats__number {
    font-size: var(--font-size-2xl);
    font-weight: var(--font-weight-bold);
    color: var(--color-primary-600);
  }

  .feature-stats__label {
    font-size: var(--font-size-sm);
    color: var(--text-tertiary);
    text-transform: uppercase;
    letter-spacing: var(--letter-spacing-wide);
  }

  .feature-action {
    margin-top: auto;
    padding-top: var(--space-4);
  }

  /* ===== CATEGORIES SECTION ===== */
  .categories-section {
    padding: var(--space-20) 0;
    background-color: var(--bg-tertiary);
  }

  .categories-grid {
    display: flex;
    flex-wrap: wrap;
    gap: var(--space-4);
    justify-content: center;
    align-items: center;
  }

  .category-chip {
    transition: var(--transition-all);
  }

  .category-chip:hover {
    transform: translateY(-2px) scale(1.05);
    box-shadow: var(--shadow-lg);
  }

  /* ===== COMMUNITY SECTION ===== */
  .community-section {
    padding: var(--space-24) 0;
    background: linear-gradient(135deg, var(--color-primary-500), var(--color-secondary-500));
  }

  .community-card {
    background: var(--bg-surface);
    border: none;
  }

  .community-content {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: var(--space-12);
    align-items: center;
  }

  .community-features__list {
    display: flex;
    flex-direction: column;
    gap: var(--space-3);
    margin: var(--space-6) 0;
  }

  .community-feature {
    display: flex;
    align-items: center;
    gap: var(--space-3);
    font-size: var(--font-size-base);
    color: var(--text-secondary);
  }

  .community-actions {
    display: flex;
    gap: var(--space-4);
    margin-top: var(--space-8);
  }

  .avatars-stack {
    display: flex;
    align-items: center;
    justify-content: center;
    margin-bottom: var(--space-6);
  }

  .avatars-stack > * {
    margin-left: calc(var(--space-3) * -1);
    border: 3px solid var(--bg-surface);
  }

  .avatars-stack > *:first-child {
    margin-left: 0;
  }

  .avatars-more {
    display: flex;
    align-items: center;
    justify-content: center;
    width: var(--size-12);
    height: var(--size-12);
    background-color: var(--color-neutral-600);
    color: var(--text-inverse);
    border-radius: var(--radius-full);
    font-size: var(--font-size-sm);
    font-weight: var(--font-weight-bold);
    margin-left: calc(var(--space-3) * -1);
    border: 3px solid var(--bg-surface);
  }

  .community-testimonial {
    text-align: center;
    padding: var(--space-6);
    background: var(--bg-secondary);
    border-radius: var(--radius-xl);
    border-left: var(--border-4) solid var(--color-primary-500);
  }

  .community-testimonial blockquote {
    font-style: italic;
    font-size: var(--font-size-lg);
    color: var(--text-secondary);
    margin-bottom: var(--space-3);
    border: none;
    background: none;
    padding: 0;
  }

  .community-testimonial cite {
    font-size: var(--font-size-sm);
    color: var(--text-tertiary);
    font-style: normal;
  }

  /* ===== FINAL CTA ===== */
  .final-cta {
    padding: var(--space-24) 0;
    background: linear-gradient(135deg, var(--color-primary-600), var(--color-accent-600));
    color: var(--text-inverse);
  }

  .cta-content {
    text-align: center;
    max-width: 800px;
    margin: 0 auto;
  }

  .cta-actions {
    display: flex;
    gap: var(--space-6);
    justify-content: center;
    margin: var(--space-8) 0;
  }

  .cta-guarantee {
    margin-top: var(--space-8);
    opacity: var(--opacity-90);
  }

  /* ===== RESPONSIVE DESIGN ===== */
  @media (max-width: 1024px) {
    .community-content {
      grid-template-columns: 1fr;
      gap: var(--space-8);
      text-align: center;
    }

    .community-actions {
      justify-content: center;
    }
  }

  @media (max-width: 768px) {
    .hero-stats__grid {
      grid-template-columns: repeat(2, 1fr);
      gap: var(--space-4);
    }

    .features-grid {
      grid-template-columns: 1fr;
      gap: var(--space-6);
    }

    .categories-grid {
      gap: var(--space-3);
    }

    .community-actions,
    .cta-actions {
      flex-direction: column;
      align-items: center;
    }

    .community-actions > *,
    .cta-actions > * {
      width: 100%;
      max-width: 300px;
    }

    .avatars-stack {
      transform: scale(0.8);
    }
  }

  @media (max-width: 480px) {
    .hero-stats__grid {
      grid-template-columns: 1fr;
    }

    .hero-stats__item {
      justify-content: center;
    }

    .section-header h2 {
      font-size: var(--font-size-3xl) !important;
    }
  }
</style>