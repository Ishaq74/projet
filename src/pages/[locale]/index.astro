---
// Home Page - Dynamic route for all locales
import Layout from '../../layouts/Layout.astro';
import Navbar from '../../components/organisms/navbar.astro';
import Hero from '../../components/organisms/hero.astro';
import Container from '../../components/atoms/container.astro';
import Heading from '../../components/atoms/heading.astro';
import Paragraph from '../../components/atoms/paragraph.astro';
import Card from '../../components/molecules/card.astro';
import Button from '../../components/atoms/button.astro';
import Icon from '../../components/atoms/icon.astro';
import { loadTranslations, t, locales } from '../../utils/i18n';
import type { Locale } from '../../types/i18n';

export async function getStaticPaths() {
  return locales.map((localeConfig) => ({
    params: { locale: localeConfig.code },
  }));
}

// Get locale from URL
const { locale } = Astro.params;
const translations = await loadTranslations(locale as Locale);

// SEO data
const title = t(translations, 'seo.home.title');
const description = t(translations, 'seo.home.description');

// Structured data for home page
const jsonLd = {
  "@context": "https://schema.org",
  "@type": "WebSite",
  "name": "Salut Annecy - Plateforme Communautaire",
  "description": description,
  "url": Astro.site?.toString(),
  "inLanguage": locale,
  "potentialAction": {
    "@type": "SearchAction",
    "target": `${Astro.site?.toString()}/${locale}/search?q={search_term_string}`,
    "query-input": "required name=search_term_string"
  }
};
---

<Layout 
  title={title}
  description={description}
  locale={locale as Locale}
  jsonLd={jsonLd}
>
  <Navbar slot="header" locale={locale as Locale} currentPath="/" />
  
  <!-- Hero Section -->
  <Hero
    title={t(translations, 'seo.home.title')}
    subtitle="Bienvenue à"
    description={t(translations, 'seo.home.description')}
    variant="gradient"
    size="xl"
    ctaPrimary={{
      text: t(translations, 'nav.restaurants'),
      href: `/${locale}/restaurants`
    }}
    ctaSecondary={{
      text: t(translations, 'nav.evenements'),
      href: `/${locale}/evenements`
    }}
  />
  
  <!-- Features Section -->
  <section class="features">
    <Container size="lg" padding="lg">
      <div class="features-header">
        <Heading level={2} size="3xl" align="center">Découvrez Annecy</Heading>
        <Paragraph size="lg" color="secondary" align="center" spacing="relaxed">
          Votre guide complet pour explorer le bassin annécien et sa communauté
        </Paragraph>
      </div>
      
      <div class="features-grid">
        <Card variant="elevated" padding="lg" hoverable>
          <div class="feature-content">
            <div class="feature-icon">
              <Icon name="location" size="xl" color="primary" />
            </div>
            <Heading level={3} size="lg" color="primary">Découverte Locale</Heading>
            <Paragraph color="secondary" spacing="relaxed">
              Explorez restaurants, hébergements, activités et événements du bassin annécien.
            </Paragraph>
          </div>
        </Card>
        
        <Card variant="elevated" padding="lg" hoverable>
          <div class="feature-content">
            <div class="feature-icon">
              <Icon name="users" size="xl" color="primary" />
            </div>
            <Heading level={3} size="lg" color="primary">Communauté</Heading>
            <Paragraph color="secondary" spacing="relaxed">
              Rejoignez forums et groupes pour échanger avec les habitants et visiteurs.
            </Paragraph>
          </div>
        </Card>
        
        <Card variant="elevated" padding="lg" hoverable>
          <div class="feature-content">
            <div class="feature-icon">
              <Icon name="briefcase" size="xl" color="primary" />
            </div>
            <Heading level={3} size="lg" color="primary">Petites Annonces</Heading>
            <Paragraph color="secondary" spacing="relaxed">
              Emploi, immobilier, vente entre particuliers dans la région d'Annecy.
            </Paragraph>
          </div>
        </Card>
        
        <Card variant="elevated" padding="lg" hoverable>
          <div class="feature-content">
            <div class="feature-icon">
              <Icon name="map" size="xl" color="primary" />
            </div>
            <Heading level={3} size="lg" color="primary">Sentiers & Nature</Heading>
            <Paragraph color="secondary" spacing="relaxed">
              Découvrez randonnées, sentiers et espaces naturels autour du lac d'Annecy.
            </Paragraph>
          </div>
        </Card>
      </div>
    </Container>
  </section>
  
  <!-- CTA Section -->
  <section class="cta-section">
    <Container size="lg" padding="lg">
      <Card variant="elevated" padding="lg">
        <div class="cta-content">
          <Heading level={2} size="2xl" align="center" color="primary">
            Rejoignez la Communauté Salut Annecy
          </Heading>
          <Paragraph size="lg" color="secondary" align="center" spacing="relaxed">
            Connectez-vous avec les habitants, découvrez les bons plans et participez à la vie locale
          </Paragraph>
          <div class="cta-actions">
            <Button variant="primary" size="lg" href={`/${locale}/auth/register`}>
              Créer un compte
            </Button>
            <Button variant="secondary" size="lg" href={`/${locale}/about`}>
              En savoir plus
            </Button>
          </div>
        </div>
      </Card>
    </Container>
  </section>
</Layout>

<style>
  .features {
    padding: var(--space-20) 0;
    background-color: var(--bg-secondary);
  }

  .features-header {
    text-align: center;
    margin-bottom: var(--space-16);
    display: flex;
    flex-direction: column;
    gap: var(--space-4);
  }

  .features-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: var(--space-8);
  }

  .feature-content {
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
    gap: var(--space-4);
  }

  .feature-icon {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 80px;
    height: 80px;
    border-radius: var(--radius-full);
    background-color: var(--color-primary-50);
    margin-bottom: var(--space-2);
  }

  [data-theme="dark"] .feature-icon {
    background-color: var(--color-primary-900);
  }

  .cta-section {
    padding: var(--space-20) 0;
    background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%);
  }

  .cta-content {
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
    gap: var(--space-6);
  }

  .cta-actions {
    display: flex;
    gap: var(--space-4);
    margin-top: var(--space-4);
  }

  /* Responsive adjustments */
  @media (max-width: 768px) {
    .features-grid {
      grid-template-columns: 1fr;
      gap: var(--space-6);
    }

    .cta-actions {
      flex-direction: column;
      width: 100%;
    }

    .cta-actions > * {
      width: 100%;
    }
  }
</style>