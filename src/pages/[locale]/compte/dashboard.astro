---
// Dashboard page - User account dashboard
import Layout from '../../../layouts/Layout.astro';
import Navigation from '../../../components/Navigation.astro';
import { loadTranslations, t, locales } from '../../../utils/i18n';
import type { Locale } from '../../../types/i18n';

export async function getStaticPaths() {
  return locales.map((localeConfig) => ({
    params: { locale: localeConfig.code },
  }));
}

const { locale } = Astro.params;
const translations = await loadTranslations(locale as Locale);

const title = `${t(translations, 'nav.dashboard')} - Salut Annecy`;
const description = "Tableau de bord de votre compte Salut Annecy";

// Mock user data
const user = {
  name: "Marie Dubois",
  email: "marie.dubois@example.com",
  avatar: "üë§",
  level: "Membre Actif",
  points: 1250,
  joinDate: "2023-06-15"
};

const stats = {
  reviews: 12,
  favorites: 28,
  contributions: 5,
  messages: 3
};

const recentActivity = [
  {
    type: "review",
    title: "Avis sur Le Palace du Lac",
    date: "2024-01-15",
    icon: "‚≠ê"
  },
  {
    type: "favorite",
    title: "Ajout√© Restaurant Chez Mamie",
    date: "2024-01-14",
    icon: "‚ù§Ô∏è"
  },
  {
    type: "contribution",
    title: "Nouveau lieu propos√©",
    date: "2024-01-13",
    icon: "üìç"
  }
];
---

<Layout title={title} description={description} locale={locale}>
  <Navigation locale={locale} currentPath="/compte/dashboard" />
  
  <main class="dashboard-page">
    <div class="container">
      <div class="dashboard-layout">
        <!-- Sidebar -->
        <aside class="dashboard-sidebar">
          <div class="user-profile">
            <div class="user-avatar">{user.avatar}</div>
            <h2 class="user-name">{user.name}</h2>
            <p class="user-level">{user.level}</p>
            <div class="user-points">{user.points} points</div>
          </div>
          
          <nav class="dashboard-nav">
            <a href={`/${locale}/compte/dashboard`} class="nav-item active">
              üè† Tableau de bord
            </a>
            <a href={`/${locale}/compte/profil`} class="nav-item">
              üë§ Mon Profil
            </a>
            <a href={`/${locale}/compte/contributions`} class="nav-item">
              üìù Mes Contributions
            </a>
            <a href={`/${locale}/compte/favoris`} class="nav-item">
              ‚ù§Ô∏è Mes Favoris
            </a>
            <a href={`/${locale}/compte/messagerie`} class="nav-item">
              üí¨ Messagerie <span class="badge">{stats.messages}</span>
            </a>
            <a href={`/${locale}/compte/annonces`} class="nav-item">
              üì¢ Mes Annonces
            </a>
            <a href={`/${locale}/compte/parametres`} class="nav-item">
              ‚öôÔ∏è Param√®tres
            </a>
          </nav>
        </aside>

        <!-- Main Content -->
        <main class="dashboard-main">
          <header class="dashboard-header">
            <h1>Bonjour {user.name} !</h1>
            <p>Bienvenue sur votre tableau de bord Salut Annecy</p>
          </header>

          <!-- Stats Cards -->
          <section class="stats-section">
            <div class="stats-grid">
              <div class="stat-card">
                <div class="stat-icon">‚≠ê</div>
                <div class="stat-content">
                  <div class="stat-number">{stats.reviews}</div>
                  <div class="stat-label">Avis publi√©s</div>
                </div>
              </div>
              <div class="stat-card">
                <div class="stat-icon">‚ù§Ô∏è</div>
                <div class="stat-content">
                  <div class="stat-number">{stats.favorites}</div>
                  <div class="stat-label">Favoris</div>
                </div>
              </div>
              <div class="stat-card">
                <div class="stat-icon">üìù</div>
                <div class="stat-content">
                  <div class="stat-number">{stats.contributions}</div>
                  <div class="stat-label">Contributions</div>
                </div>
              </div>
              <div class="stat-card">
                <div class="stat-icon">üí¨</div>
                <div class="stat-content">
                  <div class="stat-number">{stats.messages}</div>
                  <div class="stat-label">Messages</div>
                </div>
              </div>
            </div>
          </section>

          <!-- Recent Activity -->
          <section class="activity-section">
            <h2>Activit√© r√©cente</h2>
            <div class="activity-list">
              {recentActivity.map((activity) => (
                <div class="activity-item">
                  <div class="activity-icon">{activity.icon}</div>
                  <div class="activity-content">
                    <div class="activity-title">{activity.title}</div>
                    <div class="activity-date">
                      {new Date(activity.date).toLocaleDateString('fr-FR')}
                    </div>
                  </div>
                </div>
              ))}
            </div>
          </section>

          <!-- Quick Actions -->
          <section class="actions-section">
            <h2>Actions rapides</h2>
            <div class="actions-grid">
              <a href={`/${locale}/restaurants`} class="action-card">
                <div class="action-icon">üçΩÔ∏è</div>
                <div class="action-title">D√©couvrir des restaurants</div>
              </a>
              <a href={`/${locale}/annonces`} class="action-card">
                <div class="action-icon">üì¢</div>
                <div class="action-title">Publier une annonce</div>
              </a>
              <a href={`/${locale}/forums`} class="action-card">
                <div class="action-icon">üí¨</div>
                <div class="action-title">Rejoindre les forums</div>
              </a>
              <a href={`/${locale}/evenements`} class="action-card">
                <div class="action-icon">üìÖ</div>
                <div class="action-title">Voir les √©v√©nements</div>
              </a>
            </div>
          </section>
        </main>
      </div>
    </div>
  </main>
</Layout>

<style>
  .dashboard-page {
    min-height: 100vh;
    background: #f8f9fa;
    padding: 2rem 0;
  }

  .dashboard-layout {
    display: grid;
    grid-template-columns: 280px 1fr;
    gap: 2rem;
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 1rem;
  }

  .dashboard-sidebar {
    background: white;
    border-radius: 0.75rem;
    padding: 2rem;
    height: fit-content;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
  }

  .user-profile {
    text-align: center;
    margin-bottom: 2rem;
    padding-bottom: 2rem;
    border-bottom: 1px solid #e5e7eb;
  }

  .user-avatar {
    width: 80px;
    height: 80px;
    background: #e5e7eb;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 2rem;
    margin: 0 auto 1rem;
  }

  .user-name {
    font-size: 1.25rem;
    font-weight: 700;
    color: #1f2937;
    margin-bottom: 0.5rem;
  }

  .user-level {
    color: #6b7280;
    margin-bottom: 0.5rem;
  }

  .user-points {
    background: #dbeafe;
    color: #1e40af;
    padding: 0.5rem 1rem;
    border-radius: 1rem;
    font-weight: 600;
    display: inline-block;
  }

  .dashboard-nav {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
  }

  .nav-item {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0.75rem 1rem;
    color: #6b7280;
    text-decoration: none;
    border-radius: 0.5rem;
    transition: all 0.2s;
  }

  .nav-item:hover,
  .nav-item.active {
    background: #f3f4f6;
    color: #1f2937;
  }

  .nav-item.active {
    background: #dbeafe;
    color: #1e40af;
  }

  .badge {
    background: #ef4444;
    color: white;
    padding: 0.125rem 0.5rem;
    border-radius: 1rem;
    font-size: 0.75rem;
    font-weight: 600;
  }

  .dashboard-main {
    background: white;
    border-radius: 0.75rem;
    padding: 2rem;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
  }

  .dashboard-header {
    margin-bottom: 2rem;
  }

  .dashboard-header h1 {
    font-size: 2rem;
    font-weight: 700;
    color: #1f2937;
    margin-bottom: 0.5rem;
  }

  .dashboard-header p {
    color: #6b7280;
    font-size: 1.125rem;
  }

  .stats-section {
    margin-bottom: 3rem;
  }

  .stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 1.5rem;
  }

  .stat-card {
    background: #f8f9fa;
    border-radius: 0.75rem;
    padding: 1.5rem;
    display: flex;
    align-items: center;
    gap: 1rem;
  }

  .stat-icon {
    font-size: 2rem;
  }

  .stat-number {
    font-size: 2rem;
    font-weight: 700;
    color: #1f2937;
  }

  .stat-label {
    color: #6b7280;
    font-size: 0.875rem;
  }

  .activity-section,
  .actions-section {
    margin-bottom: 3rem;
  }

  .activity-section h2,
  .actions-section h2 {
    font-size: 1.5rem;
    font-weight: 700;
    color: #1f2937;
    margin-bottom: 1.5rem;
  }

  .activity-list {
    display: flex;
    flex-direction: column;
    gap: 1rem;
  }

  .activity-item {
    display: flex;
    align-items: center;
    gap: 1rem;
    padding: 1rem;
    background: #f8f9fa;
    border-radius: 0.5rem;
  }

  .activity-icon {
    font-size: 1.5rem;
  }

  .activity-title {
    font-weight: 600;
    color: #1f2937;
  }

  .activity-date {
    color: #6b7280;
    font-size: 0.875rem;
  }

  .actions-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 1.5rem;
  }

  .action-card {
    background: #f8f9fa;
    border-radius: 0.75rem;
    padding: 1.5rem;
    text-align: center;
    text-decoration: none;
    color: inherit;
    transition: transform 0.2s, box-shadow 0.2s;
  }

  .action-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px -5px rgba(0, 0, 0, 0.1);
  }

  .action-icon {
    font-size: 2.5rem;
    margin-bottom: 1rem;
  }

  .action-title {
    font-weight: 600;
    color: #1f2937;
  }

  @media (max-width: 768px) {
    .dashboard-layout {
      grid-template-columns: 1fr;
      gap: 1rem;
    }

    .dashboard-page {
      padding: 1rem 0;
    }

    .dashboard-sidebar {
      order: 2;
    }

    .dashboard-main {
      order: 1;
    }

    .stats-grid {
      grid-template-columns: repeat(2, 1fr);
    }

    .actions-grid {
      grid-template-columns: repeat(2, 1fr);
    }
  }

  @media (max-width: 480px) {
    .stats-grid,
    .actions-grid {
      grid-template-columns: 1fr;
    }
  }
</style>